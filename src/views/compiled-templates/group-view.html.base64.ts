export const tpl =
  'PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KICA8aGVhZD4KICAgIDxtZXRhIGNoYXJzZXQ9IlVURi04IiAvPgogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiIC8+CiAgICA8dGl0bGU+UHJvamVjdHMgQWN0aXZpdHk8L3RpdGxlPgogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vZWNoYXJ0c0A1LjQuMy9kaXN0L2VjaGFydHMubWluLmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2RhdGUtZm5zQDQuMS4wL2Nkbi5taW4uanMiPjwvc2NyaXB0PgogICAgPHN0eWxlPgogICAgICBib2R5IHsKICAgICAgICBmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7CiAgICAgICAgbWFyZ2luOiAyMHB4OwogICAgICAgIGNvbG9yOiAjMzMzOwogICAgICB9CiAgICAgIC5jb250YWluZXIgewogICAgICAgIG1heC13aWR0aDogMTgwMHB4OwogICAgICAgIG1hcmdpbjogMCBhdXRvOwogICAgICB9CiAgICAgIC5kYXNoYm9hcmQtaGVhZGVyIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgICAgIH0KICAgICAgLmRhc2hib2FyZC10aXRsZSB7CiAgICAgICAgbWFyZ2luOiAwOwogICAgICB9CiAgICAgIC5yb3cgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMzBweDsKICAgICAgICBnYXA6IDIwcHg7CiAgICAgIH0KICAgICAgLmNoYXJ0LWNvbnRhaW5lciB7CiAgICAgICAgZmxleDogMTsKICAgICAgICBoZWlnaHQ6IDMwMHB4OwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNlYWVhZWE7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4OwogICAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMSk7CiAgICAgIH0KICAgICAgdGFibGUgewogICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7CiAgICAgICAgbWFyZ2luLXRvcDogMTBweDsKICAgICAgICBib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLCAwLCAwLCAwLjEpOwogICAgICB9CiAgICAgIHRoLAogICAgICB0ZCB7CiAgICAgICAgcGFkZGluZzogMTJweCAxNXB4OwogICAgICAgIHRleHQtYWxpZ246IGxlZnQ7CiAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNkZGQ7CiAgICAgIH0KICAgICAgdGggewogICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmOGY4Zjg7CiAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICAgIH0KICAgICAgdHI6aG92ZXIgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmNWY1ZjU7CiAgICAgIH0KICAgICAgYSB7CiAgICAgICAgY29sb3I6ICMxYTczZTg7CiAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOwogICAgICB9CiAgICAgIGE6aG92ZXIgewogICAgICAgIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lOwogICAgICB9CiAgICAgIC50YWJsZS1jb250YWluZXIgewogICAgICAgIG1hcmdpbi10b3A6IDIwcHg7CiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2VhZWFlYTsKICAgICAgICBib3JkZXItcmFkaXVzOiA1cHg7CiAgICAgICAgcGFkZGluZzogMTVweDsKICAgICAgICBib3gtc2hhZG93OiAwIDJweCA4cHggcmdiYSgwLCAwLCAwLCAwLjEpOwogICAgICB9CiAgICAgIC50YWJsZS1mb290ZXIgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgbWFyZ2luLXRvcDogMTBweDsKICAgICAgICBtYXJnaW4tYm90dG9tOiA1cHg7CiAgICAgIH0KICAgICAgLnRhYmxlLWhlYWRlciB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBtYXJnaW4tYm90dG9tOiAxMHB4OwogICAgICB9CiAgICAgIGgyLAogICAgICBoMyB7CiAgICAgICAgbWFyZ2luOiAwOwogICAgICAgIGNvbG9yOiAjNDQ0OwogICAgICB9CiAgICAgIC5zb3VyY2UtZGVzY3JpcHRpb24gewogICAgICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsKICAgICAgICBjb2xvcjogIzY2NjsKICAgICAgfQogICAgICAuc291cmNlLWluZm8gewogICAgICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsKICAgICAgICBmb250LXNpemU6IHNtYWxsZXI7CiAgICAgICAgY29sb3I6ICM2NjY7CiAgICAgIH0KICAgICAgLyogU3dpdGNoIGJ1dHRvbiBzdHlsZXMgKi8KICAgICAgLnN3aXRjaC1jb250YWluZXIgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgfQogICAgICAuc3dpdGNoLWxhYmVsIHsKICAgICAgICBtYXJnaW46IDAgMTBweDsKICAgICAgICBmb250LXdlaWdodDogYm9sZDsKICAgICAgICBmb250LXNpemU6IDE0cHg7CiAgICAgIH0KICAgICAgLnN3aXRjaCB7CiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgICAgICB3aWR0aDogNjBweDsKICAgICAgICBoZWlnaHQ6IDI4cHg7CiAgICAgIH0KICAgICAgLnN3aXRjaCBpbnB1dCB7CiAgICAgICAgb3BhY2l0eTogMDsKICAgICAgICB3aWR0aDogMDsKICAgICAgICBoZWlnaHQ6IDA7CiAgICAgIH0KICAgICAgLnNsaWRlciB7CiAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICB0b3A6IDA7CiAgICAgICAgbGVmdDogMDsKICAgICAgICByaWdodDogMDsKICAgICAgICBib3R0b206IDA7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2NjYzsKICAgICAgICB0cmFuc2l0aW9uOiAwLjRzOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDM0cHg7CiAgICAgIH0KICAgICAgLnNsaWRlcjpiZWZvcmUgewogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICBjb250ZW50OiAnJzsKICAgICAgICBoZWlnaHQ6IDIwcHg7CiAgICAgICAgd2lkdGg6IDIwcHg7CiAgICAgICAgbGVmdDogNHB4OwogICAgICAgIGJvdHRvbTogNHB4OwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlOwogICAgICAgIHRyYW5zaXRpb246IDAuNHM7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICB9CiAgICAgIGlucHV0OmNoZWNrZWQgKyAuc2xpZGVyIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMjE5NmYzOwogICAgICB9CiAgICAgIGlucHV0OmZvY3VzICsgLnNsaWRlciB7CiAgICAgICAgYm94LXNoYWRvdzogMCAwIDFweCAjMjE5NmYzOwogICAgICB9CiAgICAgIGlucHV0OmNoZWNrZWQgKyAuc2xpZGVyOmJlZm9yZSB7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDMycHgpOwogICAgICB9CiAgICAgIC52aWV3LW1vZGUgewogICAgICAgIG1hcmdpbi1sZWZ0OiA4cHg7CiAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICAgICAgbWluLXdpZHRoOiA5MHB4OwogICAgICB9CiAgICA8L3N0eWxlPgogIDwvaGVhZD4KICA8Ym9keT4KICAgIDxhIGhyZWY9ImluZGV4Lmh0bWwiPvCflJk8L2E+CiAgICA8ZGl2IGNsYXNzPSJjb250YWluZXIiPgogICAgICA8ZGl2IGNsYXNzPSJkYXNoYm9hcmQtaGVhZGVyIj4KICAgICAgICA8aDIgaWQ9ImRhc2hib2FyZC10aXRsZSIgY2xhc3M9ImRhc2hib2FyZC10aXRsZSI+PC9oMj4KICAgICAgICA8ZGl2IGNsYXNzPSJzd2l0Y2gtY29udGFpbmVyIj4KICAgICAgICAgIDxzcGFuIGNsYXNzPSJzd2l0Y2gtbGFiZWwiPlN0b3J5IFBvaW50czwvc3Bhbj4KICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic3dpdGNoIj4KICAgICAgICAgICAgPGlucHV0IHR5cGU9ImNoZWNrYm94IiBpZD0idmlldy1tb2RlLXN3aXRjaCIgLz4KICAgICAgICAgICAgPHNwYW4gY2xhc3M9InNsaWRlciI+PC9zcGFuPgogICAgICAgICAgPC9sYWJlbD4KICAgICAgICAgIDxzcGFuIGNsYXNzPSJzd2l0Y2gtbGFiZWwiPkNvdW50PC9zcGFuPgogICAgICAgIDwvZGl2PgogICAgICA8L2Rpdj4KICAgICAgPHAgY2xhc3M9InNvdXJjZS1kZXNjcmlwdGlvbiIgaWQ9ImRhc2hib2FyZC1kZXNjcmlwdGlvbiI+PC9wPgogICAgICA8cCBjbGFzcz0ic291cmNlLWluZm8iIGlkPSJkYXNoYm9hcmQtbWV0YWRhdGEiPjwvcD4KCiAgICAgIDxkaXYgY2xhc3M9InJvdyI+CiAgICAgICAgPGRpdiBjbGFzcz0iY2hhcnQtY29udGFpbmVyIiBpZD0id2Vla2x5Y29tcGxldGlvbmNoYXJ0Ij48L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJjaGFydC1jb250YWluZXIiIGlkPSJ3ZWVrbHl2ZWxvY2l0eWNoYXJ0Ij48L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJjaGFydC1jb250YWluZXIiIGlkPSJlZmZvcnRkaXN0cmlidXRpb25jaGFydCI+PC9kaXY+CiAgICAgIDwvZGl2PgoKICAgICAgPGRpdiBjbGFzcz0idGFibGUtY29udGFpbmVyIj4KICAgICAgICA8ZGl2IGNsYXNzPSJ0YWJsZS1oZWFkZXIiPgogICAgICAgICAgPGgzIGlkPSJ0YWJsZS10aXRsZSI+PC9oMz4KICAgICAgICAgIDxzcGFuIGlkPSJzZWxlY3RlZC1zb3VyY2UiCiAgICAgICAgICAgID5DbGljayBvbiBhbnkgY2hhcnQgYmFyIHRvIHNlZSBkZXRhaWxzPC9zcGFuCiAgICAgICAgICA+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPHRhYmxlPgogICAgICAgICAgPHRoZWFkPgogICAgICAgICAgICA8dHI+CiAgICAgICAgICAgICAgPHRoPiM8L3RoPgogICAgICAgICAgICAgIDx0aD5UaXRsZTwvdGg+CiAgICAgICAgICAgICAgPHRoPlR5cGU8L3RoPgogICAgICAgICAgICAgIDx0aD5SZXBvPC90aD4KICAgICAgICAgICAgICA8dGg+TWlsZXN0b25lPC90aD4KICAgICAgICAgICAgICA8dGg+UG9pbnRzPC90aD4KICAgICAgICAgICAgPC90cj4KICAgICAgICAgIDwvdGhlYWQ+CiAgICAgICAgICA8dGJvZHkgaWQ9ImRldGFpbHMtdGFibGUiPgogICAgICAgICAgICA8dHI+CiAgICAgICAgICAgICAgPHRkIGNvbHNwYW49IjMiPk5vIGRhdGEgc2VsZWN0ZWQ8L3RkPgogICAgICAgICAgICA8L3RyPgogICAgICAgICAgPC90Ym9keT4KICAgICAgICA8L3RhYmxlPgogICAgICA8L2Rpdj4KCiAgICAgIDxwIGNsYXNzPSJzb3VyY2UtaW5mbyIgaWQ9ImRhc2hib2FyZC1wcm9qZWN0ZmlsdGVyIj48L3A+CgogICAgICA8ZGl2IGNsYXNzPSJ0YWJsZS1jb250YWluZXIiPgogICAgICAgIDxkaXYgY2xhc3M9InRhYmxlLWhlYWRlciI+CiAgICAgICAgICA8aDM+RGF0YSBTdHJlYW1zPC9oMz4KICAgICAgICA8L2Rpdj4KICAgICAgICA8dGFibGU+CiAgICAgICAgICA8dGhlYWQ+CiAgICAgICAgICAgIDx0cj4KICAgICAgICAgICAgICA8dGg+TmFtZTwvdGg+CiAgICAgICAgICAgICAgPHRoPkRlc2NyaXB0aW9uPC90aD4KICAgICAgICAgICAgICA8dGg+UXVlcnk8L3RoPgogICAgICAgICAgICA8L3RyPgogICAgICAgICAgPC90aGVhZD4KICAgICAgICAgIDx0Ym9keSBpZD0iZGV0YWlscy10YWJsZS1zdHJlYW0iPgogICAgICAgICAgICA8dHI+CiAgICAgICAgICAgICAgPHRkIGNvbHNwYW49IjMiPk5vIGRhdGEgc2VsZWN0ZWQ8L3RkPgogICAgICAgICAgICA8L3RyPgogICAgICAgICAgPC90Ym9keT4KICAgICAgICA8L3RhYmxlPgogICAgICAgIDxkaXYgY2xhc3M9InRhYmxlLWZvb3RlciI+CiAgICAgICAgICA8c3BhbgogICAgICAgICAgICA+PGkKICAgICAgICAgICAgICA+U3RyZWFtcyBhcmUgcXVlcmllcyBleGVjdXRlZCBhZ2FpbnN0IEFMTCBJc3N1ZXMgYW5kIFB1bGwgUmVxdWVzdHMKICAgICAgICAgICAgICAoUFIpIGF0dGFjaGVkIHRvIHRoZSBzZWxlY3RlZCBwcm9qZWN0LiA8YnIgLz4KICAgICAgICAgICAgICBUaGVpciBvcmRlciBtYXR0ZXJzLCBpZiBhIElzc3VlIG9yIFBSIGlzIHByZXNlbnQgaW4gdGhlIGZpcnN0CiAgICAgICAgICAgICAgc3RyZWFtLCBpdCB3aWxsIGJlIGlnbm9yZWQgb24gdGhlIGZvbGxvd2luZyBzdHJlYW1zLiBUaGlzIHByZXZlbnRzCiAgICAgICAgICAgICAgaXNzdWVzL1BScyBmcm9tIGJlaW5nIGNvdW50ZWQgbXVsdGlwbGUgdGltZXMuPC9pCiAgICAgICAgICAgID48L3NwYW4KICAgICAgICAgID4KICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8c2NyaXB0PgogICAgICBjb25zdCBiYXNlNjREZWNvZGVVbmljb2RlID0gKGJhc2U2NFN0cmluZykgPT4gewogICAgICAgIGNvbnN0IGJpbmFyeVN0cmluZyA9IHdpbmRvdy5hdG9iKGJhc2U2NFN0cmluZykKICAgICAgICBjb25zdCBieXRlcyA9IG5ldyBVaW50OEFycmF5KGJpbmFyeVN0cmluZy5sZW5ndGgpCgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmluYXJ5U3RyaW5nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBieXRlc1tpXSA9IGJpbmFyeVN0cmluZy5jaGFyQ29kZUF0KGkpCiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCd1dGYtOCcpLmRlY29kZShieXRlcykKICAgICAgfQoKICAgICAgLy8gU2luZ2xlIEphdmFTY3JpcHQgZGF0YSBvYmplY3QgY29udGFpbmluZyBhbGwgb3VyIGRhdGEKICAgICAgY29uc3Qgc3JjRGF0YSA9IGJhc2U2NERlY29kZVVuaWNvZGUoJ1JFUExBQ0VfTUUnKQogICAgICBjb25zdCBncm91cE1ldHJpY3MgPSBKU09OLnBhcnNlKHNyY0RhdGEpCiAgICAgIGNvbnNvbGUubG9nKCdTb3VyY2UgZGF0YSBkZWNvZGVkJywgZ3JvdXBNZXRyaWNzKQoKICAgICAgLy8gQ29waWVkIHRvIHRoZSB3aW5kb3cgb2JqZWN0IHRvIGZhY2lsaXRhdGUgYnVpbGRpbmcgb2YgcXVlcmllcwogICAgICB3aW5kb3cuZGF0YU5vZGVzID0gZ3JvdXBNZXRyaWNzLm5vZGVzCgogICAgICBkb2N1bWVudC50aXRsZSA9IGdyb3VwTWV0cmljcy5uYW1lCgogICAgICAvLyBVcGRhdGUgdGhlIHRhYmxlIHdpdGggZGF0YSBjbGlja2VkIGluIHRoZSBjaGFydAogICAgICBmdW5jdGlvbiB1cGRhdGVUYWJsZSh7IHNyY0NoYXJ0LCBzZWxlY3Rpb24sIG5vZGVzIH0pIHsKICAgICAgICBjb25zb2xlLmxvZygnVXBkYXRpbmcgdGFibGUgd2l0aCBkYXRhIGNvbWluZyBmcm9tOicsIHNyY0NoYXJ0KQoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFibGUtdGl0bGUnKS50ZXh0Q29udGVudCA9CiAgICAgICAgICBgTm9kZXMgZnJvbSAke3NyY0NoYXJ0fWAKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsZWN0ZWQtc291cmNlJykudGV4dENvbnRlbnQgPQogICAgICAgICAgYFNlbGVjdGlvbjogJHtzZWxlY3Rpb259YAoKICAgICAgICBjb25zdCB0YWJsZUJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGV0YWlscy10YWJsZScpCiAgICAgICAgdGFibGVCb2R5LmlubmVySFRNTCA9ICcnCgogICAgICAgIG5vZGVzLmZvckVhY2goKG5vZGUpID0+IHsKICAgICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJykKICAgICAgICAgIHJvdy5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8dGQ+JHtub2RlLm51bWJlcn08L3RkPgogICAgICAgICAgICAgICAgPHRkPjxhIGhyZWY9IiR7bm9kZS51cmx9IiB0YXJnZXQ9Il9ibGFuayI+JHtub2RlLnRpdGxlfTwvYT48L3RkPgogICAgICAgICAgICAgICAgPHRkPiR7bm9kZS50eXBlfTwvdGQ+CiAgICAgICAgICAgICAgICA8dGQ+PGEgaHJlZj0iJHtub2RlLnJlcG9zaXRvcnkudXJsfSIgdGFyZ2V0PSJfYmxhbmsiPiR7bm9kZS5yZXBvc2l0b3J5Lm93bmVyLmxvZ2lufS8ke25vZGUucmVwb3NpdG9yeS5uYW1lfTwvYT48L3RkPgogICAgICAgICAgICAgICAgPHRkPiR7bm9kZS5taWxlc3RvbmU/LnRpdGxlID8gbm9kZS5taWxlc3RvbmU/LnRpdGxlIDogJyd9PC90ZD4KICAgICAgICAgICAgICAgIDx0ZD4ke25vZGUucG9pbnRzfTwvdGQ+CiAgICAgICAgICAgICAgYAogICAgICAgICAgdGFibGVCb2R5LmFwcGVuZENoaWxkKHJvdykKICAgICAgICB9KQogICAgICB9CgogICAgICBmdW5jdGlvbiB1cGRhdGVTdHJlYW1zVGFibGUoc3JjRGF0YSkgewogICAgICAgIGNvbnN0IHRhYmxlQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZXRhaWxzLXRhYmxlLXN0cmVhbScpCiAgICAgICAgdGFibGVCb2R5LmlubmVySFRNTCA9ICcnCgogICAgICAgIHNyY0RhdGEuc3RyZWFtcy5mb3JFYWNoKChzdHJlYW0pID0+IHsKICAgICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJykKICAgICAgICAgIHJvdy5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8dGQ+JHtzdHJlYW0ubmFtZX08L3RkPgogICAgICAgICAgICAgICAgPHRkPiR7c3RyZWFtLmRlc2NyaXB0aW9ufTwvdGQ+CiAgICAgICAgICAgICAgICA8dGQ+JHtKU09OLnN0cmluZ2lmeShzdHJlYW0ucXVlcnkpfTwvdGQ+CiAgICAgICAgICAgICAgYAogICAgICAgICAgdGFibGVCb2R5LmFwcGVuZENoaWxkKHJvdykKICAgICAgICB9KQogICAgICB9CgogICAgICBjb25zdCB0b29sdGlwRm9ybWF0dGVyID0gKHBhcmFtcykgPT4gewogICAgICAgIC8vIExpbWl0IHRvb2x0aXAgdG8gdG9wIDEwIHZhbHVlcyBhdCB0aGUgcG9pbnQKICAgICAgICBjb25zdCBzb3J0ZWRQYXJhbXMgPSBbLi4ucGFyYW1zXS5zb3J0KChhLCBiKSA9PiBiLnZhbHVlIC0gYS52YWx1ZSkKICAgICAgICBjb25zdCBsaW1pdGVkID0gc29ydGVkUGFyYW1zLnNsaWNlKDAsIDEwKQoKICAgICAgICBsZXQgcmVzdWx0ID0gYCR7bGltaXRlZFswXS5heGlzVmFsdWV9PGJyPmAKICAgICAgICBsaW1pdGVkLmZvckVhY2goKHBhcmFtKSA9PiB7CiAgICAgICAgICByZXN1bHQgKz0gYCR7cGFyYW0ubWFya2VyfSAke3BhcmFtLnNlcmllc05hbWV9OiAke3BhcmFtLnZhbHVlLnRvRml4ZWQoMil9PGJyPmAKICAgICAgICB9KQoKICAgICAgICBpZiAocGFyYW1zLmxlbmd0aCA+IDEwKSB7CiAgICAgICAgICByZXN1bHQgKz0gYDxpPi4uLiBhbmQgJHtwYXJhbXMubGVuZ3RoIC0gMTB9IG1vcmU8L2k+YAogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICB9CgogICAgICBmdW5jdGlvbiBjcmVhdGVXZWVrbHlDb21wbGV0aW9uQ2hhcnQoZWxlbWVudElkLCBkYXRhLCBtZXRyaWMpIHsKICAgICAgICBjb25zdCBjaGFydERvbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnRJZCkKICAgICAgICBjb25zdCBteUNoYXJ0ID0gZWNoYXJ0cy5pbml0KGNoYXJ0RG9tKQoKICAgICAgICBjb25zdCB2aXNpYmxlQ291bnQgPSAyMAogICAgICAgIGNvbnN0IHN0YXJ0UGVyY2VudGFnZSA9CiAgICAgICAgICAoKGRhdGEud2Vla3MubGVuZ3RoIC0gdmlzaWJsZUNvdW50KSAvIGRhdGEud2Vla3MubGVuZ3RoKSAqIDEwMAogICAgICAgIGNvbnN0IGVuZFBlcmNlbnRhZ2UgPSAxMDAKCiAgICAgICAgY29uc3QgY2hhcnRUaXRsZSA9ICdXZWVrbHkgQ29tcGxldGlvbicKCiAgICAgICAgY29uc3QgaGlnaGVzdFZhbHVlID0gTWF0aC5tYXgoCiAgICAgICAgICAuLi5kYXRhLndlZWtzLm1hcCgod2VlaykgPT4gd2Vlay5tZXRyaWNzLm5vZGVzLmNvdW50KQogICAgICAgICkKICAgICAgICBjb25zdCByb3VuZFVwSGlnaGVzdCA9IE1hdGguY2VpbChoaWdoZXN0VmFsdWUgLyAxMCkgKiAxMAoKICAgICAgICBjb25zdCBvcHRpb24gPSB7CiAgICAgICAgICB0aXRsZTogewogICAgICAgICAgICB0ZXh0OiBjaGFydFRpdGxlLAogICAgICAgICAgICBwb3NpdGlvbjogJ3RvcCcsCiAgICAgICAgICAgIGxlZnQ6ICdjZW50ZXInLAogICAgICAgICAgICB0ZXh0U3R5bGU6IHsKICAgICAgICAgICAgICBmb250U2l6ZTogMTQKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIGxlZ2VuZDogewogICAgICAgICAgICB0eXBlOiAnc2Nyb2xsJywKICAgICAgICAgICAgdG9wOiAndG9wJywKICAgICAgICAgICAgbGVmdDogJ2NlbnRlcicsCiAgICAgICAgICAgIHRvcDogMzAKICAgICAgICAgIH0sCiAgICAgICAgICB0b29sdGlwOiB7CiAgICAgICAgICAgIHRyaWdnZXI6ICdheGlzJywKICAgICAgICAgICAgYXhpc1BvaW50ZXI6IHsKICAgICAgICAgICAgICB0eXBlOiAnc2hhZG93JwogICAgICAgICAgICB9LAogICAgICAgICAgICBmb3JtYXR0ZXI6IGZ1bmN0aW9uIChwYXJhbXMpIHsKICAgICAgICAgICAgICByZXR1cm4gdG9vbHRpcEZvcm1hdHRlcihwYXJhbXMpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICBncmlkOiB7CiAgICAgICAgICAgIGxlZnQ6ICczJScsCiAgICAgICAgICAgIHJpZ2h0OiAnNCUnLAogICAgICAgICAgICBib3R0b206ICczJScsCiAgICAgICAgICAgIHRvcDogJzMwJScsCiAgICAgICAgICAgIGNvbnRhaW5MYWJlbDogdHJ1ZQogICAgICAgICAgfSwKICAgICAgICAgIGRhdGFab29tOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0eXBlOiAnaW5zaWRlJywgLy8gQWxsb3dzIHNjcm9sbGluZyB3aXRoIG1vdXNlIG9yIHRvdWNoIGdlc3R1cmVzCiAgICAgICAgICAgICAgeEF4aXNJbmRleDogMCwKICAgICAgICAgICAgICBzdGFydDogc3RhcnRQZXJjZW50YWdlLAogICAgICAgICAgICAgIGVuZDogZW5kUGVyY2VudGFnZQogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgeEF4aXM6IHsKICAgICAgICAgICAgdHlwZTogJ2NhdGVnb3J5JywKICAgICAgICAgICAgYXhpc0xhYmVsOiB7IGludGVydmFsOiAwLCByb3RhdGU6IDMwIH0sCiAgICAgICAgICAgIGRhdGE6IGRhdGEud2Vla3MubWFwKCh2YWx1ZSwgaW5kZXgpID0+CiAgICAgICAgICAgICAgZGF0ZUZucy5mb3JtYXQobmV3IERhdGUodmFsdWUuZmlyc3REYXkpLCAnTExMIGRvJykKICAgICAgICAgICAgKQogICAgICAgICAgfSwKICAgICAgICAgIHlBeGlzOiB7CiAgICAgICAgICAgIHR5cGU6ICd2YWx1ZScsCiAgICAgICAgICAgIG1pbjogMCwKICAgICAgICAgICAgbWF4OiByb3VuZFVwSGlnaGVzdAogICAgICAgICAgfSwKICAgICAgICAgIHNlcmllczogWwogICAgICAgICAgICAuLi5kYXRhLnN0cmVhbXMubWFwKChzdHJlYW0sIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIG5hbWU6IHN0cmVhbS5uYW1lLAogICAgICAgICAgICAgICAgdHlwZTogJ2JhcicsCiAgICAgICAgICAgICAgICBzdGFjazogJ2FkJywKICAgICAgICAgICAgICAgIGRhdGE6IHN0cmVhbS53ZWVrcy5tYXAoCiAgICAgICAgICAgICAgICAgICh2YWx1ZSwgaW5kZXgpID0+IHZhbHVlLm1ldHJpY3NbbWV0cmljXS5jb3VudAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSksCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBuYW1lOiAnVG90YWwnLAogICAgICAgICAgICAgIHR5cGU6ICdsaW5lJywKICAgICAgICAgICAgICBkYXRhOiBkYXRhLndlZWtzLm1hcCgod2VlaywgaW5kZXgpID0+IHdlZWsubWV0cmljc1ttZXRyaWNdLmNvdW50KQogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfQoKICAgICAgICAvLyBBcHBseSBvcHRpb25zIHRvIGNoYXJ0CiAgICAgICAgbXlDaGFydC5zZXRPcHRpb24ob3B0aW9uKQoKICAgICAgICAvLyBBZGQgY2xpY2sgZXZlbnQgZm9yIGludGVyYWN0aXZpdHkKICAgICAgICBteUNoYXJ0Lm9uKCdjbGljaycsIGZ1bmN0aW9uIChwYXJhbXMpIHsKICAgICAgICAgIGNvbnN0IHN0cmVhbU5hbWUgPSBwYXJhbXMuc2VyaWVzTmFtZQogICAgICAgICAgY29uc3Qgc3RyZWFtSW5kZXggPSBwYXJhbXMuZGF0YUluZGV4CiAgICAgICAgICBjb25zdCBzdHJlYW0gPSBkYXRhLnN0cmVhbXMuZmluZCgKICAgICAgICAgICAgKHN0cmVhbSkgPT4gc3RyZWFtLm5hbWUgPT09IHN0cmVhbU5hbWUKICAgICAgICAgICkKICAgICAgICAgIGlmIChzdHJlYW0gJiYgc3RyZWFtLndlZWtzW3N0cmVhbUluZGV4XSkgewogICAgICAgICAgICB1cGRhdGVUYWJsZSh7CiAgICAgICAgICAgICAgc3JjQ2hhcnQ6IGNoYXJ0VGl0bGUsCiAgICAgICAgICAgICAgc2VsZWN0aW9uOiBgJHtzdHJlYW1OYW1lfSBvbiAke2RhdGVGbnMuZm9ybWF0KG5ldyBEYXRlKHN0cmVhbS53ZWVrc1tzdHJlYW1JbmRleF0uZmlyc3REYXkpLCAnTExMIGRvJyl9ICgke3N0cmVhbS53ZWVrc1tzdHJlYW1JbmRleF0ubm9kZXMubGVuZ3RofSBub2RlcylgLAogICAgICAgICAgICAgIG5vZGVzOiBzdHJlYW0ud2Vla3Nbc3RyZWFtSW5kZXhdLm5vZGVzCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgfSkKCiAgICAgICAgLy8gTWFrZSBjaGFydCByZXNwb25zaXZlCiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIG15Q2hhcnQucmVzaXplKCkKICAgICAgICB9KQoKICAgICAgICByZXR1cm4gbXlDaGFydAogICAgICB9CgogICAgICBmdW5jdGlvbiBjcmVhdGVXZWVrbHlWZWxvY2l0eUNoYXJ0KGVsZW1lbnRJZCwgZGF0YSwgbWV0cmljKSB7CiAgICAgICAgY29uc3QgY2hhcnREb20gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50SWQpCiAgICAgICAgY29uc3QgbXlDaGFydCA9IGVjaGFydHMuaW5pdChjaGFydERvbSkKCiAgICAgICAgY29uc3QgdmlzaWJsZUNvdW50ID0gMjAKICAgICAgICBjb25zdCBzdGFydFBlcmNlbnRhZ2UgPQogICAgICAgICAgKChkYXRhLndlZWtzLmxlbmd0aCAtIHZpc2libGVDb3VudCkgLyBkYXRhLndlZWtzLmxlbmd0aCkgKiAxMDAKICAgICAgICBjb25zdCBlbmRQZXJjZW50YWdlID0gMTAwCgogICAgICAgIGNvbnN0IGNoYXJ0VGl0bGUgPSAnV2Vla2x5IFZlbG9jaXR5JwoKICAgICAgICBjb25zdCBoaWdoZXN0VmFsdWUgPSBNYXRoLm1heCgKICAgICAgICAgIC4uLmRhdGEud2Vla3MubWFwKCh3ZWVrKSA9PiB3ZWVrLm1ldHJpY3Mubm9kZXMudmVsb2NpdHkpCiAgICAgICAgKQogICAgICAgIGNvbnN0IHJvdW5kVXBIaWdoZXN0ID0gTWF0aC5jZWlsKGhpZ2hlc3RWYWx1ZSAvIDEwKSAqIDEwCgogICAgICAgIGNvbnN0IG9wdGlvbiA9IHsKICAgICAgICAgIHRpdGxlOiB7CiAgICAgICAgICAgIHRleHQ6IGNoYXJ0VGl0bGUsCiAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wJywKICAgICAgICAgICAgbGVmdDogJ2NlbnRlcicsCiAgICAgICAgICAgIHRleHRTdHlsZTogewogICAgICAgICAgICAgIGZvbnRTaXplOiAxNAogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgbGVnZW5kOiB7CiAgICAgICAgICAgIHR5cGU6ICdzY3JvbGwnLAogICAgICAgICAgICB0b3A6ICd0b3AnLAogICAgICAgICAgICBsZWZ0OiAnY2VudGVyJywKICAgICAgICAgICAgdG9wOiAzMAogICAgICAgICAgfSwKICAgICAgICAgIHRvb2x0aXA6IHsKICAgICAgICAgICAgdHJpZ2dlcjogJ2F4aXMnLAogICAgICAgICAgICBheGlzUG9pbnRlcjogewogICAgICAgICAgICAgIHR5cGU6ICdzaGFkb3cnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24gKHBhcmFtcykgewogICAgICAgICAgICAgIHJldHVybiB0b29sdGlwRm9ybWF0dGVyKHBhcmFtcykKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIGdyaWQ6IHsKICAgICAgICAgICAgbGVmdDogJzMlJywKICAgICAgICAgICAgcmlnaHQ6ICc0JScsCiAgICAgICAgICAgIGJvdHRvbTogJzMlJywKICAgICAgICAgICAgdG9wOiAnMzAlJywKICAgICAgICAgICAgY29udGFpbkxhYmVsOiB0cnVlCiAgICAgICAgICB9LAogICAgICAgICAgZGF0YVpvb206IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICdpbnNpZGUnLCAvLyBBbGxvd3Mgc2Nyb2xsaW5nIHdpdGggbW91c2Ugb3IgdG91Y2ggZ2VzdHVyZXMKICAgICAgICAgICAgICB4QXhpc0luZGV4OiAwLAogICAgICAgICAgICAgIHN0YXJ0OiBzdGFydFBlcmNlbnRhZ2UsCiAgICAgICAgICAgICAgZW5kOiBlbmRQZXJjZW50YWdlCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICB4QXhpczogewogICAgICAgICAgICB0eXBlOiAnY2F0ZWdvcnknLAogICAgICAgICAgICBheGlzTGFiZWw6IHsgaW50ZXJ2YWw6IDAsIHJvdGF0ZTogMzAgfSwKICAgICAgICAgICAgZGF0YTogZGF0YS53ZWVrcy5tYXAoKHZhbHVlLCBpbmRleCkgPT4KICAgICAgICAgICAgICBkYXRlRm5zLmZvcm1hdChuZXcgRGF0ZSh2YWx1ZS5maXJzdERheSksICdMTEwgZG8nKQogICAgICAgICAgICApCiAgICAgICAgICB9LAogICAgICAgICAgeUF4aXM6IHsKICAgICAgICAgICAgdHlwZTogJ3ZhbHVlJywKICAgICAgICAgICAgbWluOiAwLAogICAgICAgICAgICBtYXg6IHJvdW5kVXBIaWdoZXN0CiAgICAgICAgICB9LAogICAgICAgICAgc2VyaWVzOiBbCiAgICAgICAgICAgIC4uLmRhdGEuc3RyZWFtcy5tYXAoKHN0cmVhbSwgaW5kZXgpID0+IHsKICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgbmFtZTogc3RyZWFtLm5hbWUsCiAgICAgICAgICAgICAgICB0eXBlOiAnbGluZScsCiAgICAgICAgICAgICAgICBkYXRhOiBzdHJlYW0ud2Vla3MubWFwKAogICAgICAgICAgICAgICAgICAodmFsdWUsIGluZGV4KSA9PiB2YWx1ZS5tZXRyaWNzW21ldHJpY10udmVsb2NpdHkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogJ1RvdGFsJywKICAgICAgICAgICAgICB0eXBlOiAnbGluZScsCiAgICAgICAgICAgICAgZGF0YTogZGF0YS53ZWVrcy5tYXAoCiAgICAgICAgICAgICAgICAod2VlaywgaW5kZXgpID0+IHdlZWsubWV0cmljc1ttZXRyaWNdLnZlbG9jaXR5CiAgICAgICAgICAgICAgKQogICAgICAgICAgICB9CiAgICAgICAgICBdCiAgICAgICAgfQoKICAgICAgICAvLyBBcHBseSBvcHRpb25zIHRvIGNoYXJ0CiAgICAgICAgbXlDaGFydC5zZXRPcHRpb24ob3B0aW9uKQoKICAgICAgICAvLyBNYWtlIGNoYXJ0IHJlc3BvbnNpdmUKICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgbXlDaGFydC5yZXNpemUoKQogICAgICAgIH0pCgogICAgICAgIHJldHVybiBteUNoYXJ0CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGNyZWF0ZUVmZm9ydERpc3RyaWJ1dGlvbkNoYXJ0KGVsZW1lbnRJZCwgZGF0YSwgbWV0cmljKSB7CiAgICAgICAgY29uc3QgY2hhcnREb20gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50SWQpCiAgICAgICAgY29uc3QgbXlDaGFydCA9IGVjaGFydHMuaW5pdChjaGFydERvbSkKCiAgICAgICAgY29uc3QgdmlzaWJsZUNvdW50ID0gMjAKICAgICAgICBjb25zdCBzdGFydFBlcmNlbnRhZ2UgPQogICAgICAgICAgKChkYXRhLndlZWtzLmxlbmd0aCAtIHZpc2libGVDb3VudCkgLyBkYXRhLndlZWtzLmxlbmd0aCkgKiAxMDAKICAgICAgICBjb25zdCBlbmRQZXJjZW50YWdlID0gMTAwCgogICAgICAgIGNvbnN0IGNoYXJ0VGl0bGUgPSAnRWZmb3J0IERpc3RyaWJ1dGlvbiAoJSknCgogICAgICAgIGNvbnN0IG9wdGlvbiA9IHsKICAgICAgICAgIHRpdGxlOiB7CiAgICAgICAgICAgIHRleHQ6IGNoYXJ0VGl0bGUsCiAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wJywKICAgICAgICAgICAgbGVmdDogJ2NlbnRlcicsCiAgICAgICAgICAgIHRleHRTdHlsZTogewogICAgICAgICAgICAgIGZvbnRTaXplOiAxNAogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgbGVnZW5kOiB7CiAgICAgICAgICAgIHR5cGU6ICdzY3JvbGwnLAogICAgICAgICAgICB0b3A6ICd0b3AnLAogICAgICAgICAgICBsZWZ0OiAnY2VudGVyJywKICAgICAgICAgICAgdG9wOiAzMAogICAgICAgICAgfSwKICAgICAgICAgIHRvb2x0aXA6IHsKICAgICAgICAgICAgdHJpZ2dlcjogJ2F4aXMnLAogICAgICAgICAgICBheGlzUG9pbnRlcjogewogICAgICAgICAgICAgIHR5cGU6ICdzaGFkb3cnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24gKHBhcmFtcykgewogICAgICAgICAgICAgIHJldHVybiB0b29sdGlwRm9ybWF0dGVyKHBhcmFtcykKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIGdyaWQ6IHsKICAgICAgICAgICAgbGVmdDogJzMlJywKICAgICAgICAgICAgcmlnaHQ6ICc0JScsCiAgICAgICAgICAgIGJvdHRvbTogJzMlJywKICAgICAgICAgICAgdG9wOiAnMzAlJywKICAgICAgICAgICAgY29udGFpbkxhYmVsOiB0cnVlCiAgICAgICAgICB9LAogICAgICAgICAgZGF0YVpvb206IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIHR5cGU6ICdpbnNpZGUnLCAvLyBBbGxvd3Mgc2Nyb2xsaW5nIHdpdGggbW91c2Ugb3IgdG91Y2ggZ2VzdHVyZXMKICAgICAgICAgICAgICB4QXhpc0luZGV4OiAwLAogICAgICAgICAgICAgIHN0YXJ0OiBzdGFydFBlcmNlbnRhZ2UsCiAgICAgICAgICAgICAgZW5kOiBlbmRQZXJjZW50YWdlCiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICB4QXhpczogewogICAgICAgICAgICB0eXBlOiAnY2F0ZWdvcnknLAogICAgICAgICAgICBheGlzTGFiZWw6IHsgaW50ZXJ2YWw6IDAsIHJvdGF0ZTogMzAgfSwKICAgICAgICAgICAgZGF0YTogZGF0YS53ZWVrcy5tYXAoKHZhbHVlLCBpbmRleCkgPT4KICAgICAgICAgICAgICBkYXRlRm5zLmZvcm1hdChuZXcgRGF0ZSh2YWx1ZS5maXJzdERheSksICdMTEwgZG8nKQogICAgICAgICAgICApCiAgICAgICAgICB9LAogICAgICAgICAgeUF4aXM6IHsKICAgICAgICAgICAgdHlwZTogJ3ZhbHVlJywKICAgICAgICAgICAgbWluOiAwLAogICAgICAgICAgICBtYXg6IDEwMAogICAgICAgICAgfSwKICAgICAgICAgIHNlcmllczogWwogICAgICAgICAgICAuLi5kYXRhLnN0cmVhbXMubWFwKChzdHJlYW0sIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIG5hbWU6IHN0cmVhbS5uYW1lLAogICAgICAgICAgICAgICAgdHlwZTogJ2JhcicsCiAgICAgICAgICAgICAgICBzdGFjazogJ2FkJywKICAgICAgICAgICAgICAgIGRhdGE6IHN0cmVhbS53ZWVrcy5tYXAoCiAgICAgICAgICAgICAgICAgICh2YWx1ZSwgaW5kZXgpID0+IHZhbHVlLm1ldHJpY3NbbWV0cmljXS5kaXN0cmlidXRpb24KICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBiYXJXaWR0aDogJzEwMCUnLCAvLyBFbnN1cmVzIGJhcnMgZmlsbCB0aGVpciBhbGxvY2F0ZWQgc3BhY2UKICAgICAgICAgICAgICAgIGJhckdhcDogJzAlJywgLy8gUmVtb3ZlcyBzcGFjaW5nIGJldHdlZW4gc2VyaWVzIChpZiBtdWx0aXBsZSkKICAgICAgICAgICAgICAgIGJhckNhdGVnb3J5R2FwOiAnMCUnIC8vIFJlbW92ZXMgc3BhY2luZyBiZXR3ZWVuIGNhdGVnb3JpZXMKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICBdCiAgICAgICAgfQoKICAgICAgICAvLyBBcHBseSBvcHRpb25zIHRvIGNoYXJ0CiAgICAgICAgbXlDaGFydC5zZXRPcHRpb24ob3B0aW9uKQoKICAgICAgICAvLyBBZGQgY2xpY2sgZXZlbnQgZm9yIGludGVyYWN0aXZpdHkKICAgICAgICBteUNoYXJ0Lm9uKCdjbGljaycsIGZ1bmN0aW9uIChwYXJhbXMpIHsKICAgICAgICAgIGNvbnN0IHN0cmVhbU5hbWUgPSBwYXJhbXMuc2VyaWVzTmFtZQogICAgICAgICAgY29uc3Qgc3RyZWFtSW5kZXggPSBwYXJhbXMuZGF0YUluZGV4CiAgICAgICAgICBjb25zdCBzdHJlYW0gPSBkYXRhLnN0cmVhbXMuZmluZCgKICAgICAgICAgICAgKHN0cmVhbSkgPT4gc3RyZWFtLm5hbWUgPT09IHN0cmVhbU5hbWUKICAgICAgICAgICkKICAgICAgICAgIGlmIChzdHJlYW0gJiYgc3RyZWFtLndlZWtzW3N0cmVhbUluZGV4XSkgewogICAgICAgICAgICB1cGRhdGVUYWJsZSh7CiAgICAgICAgICAgICAgc3JjQ2hhcnQ6IGNoYXJ0VGl0bGUsCiAgICAgICAgICAgICAgc2VsZWN0aW9uOiBgJHtzdHJlYW1OYW1lfSBvbiAke2RhdGVGbnMuZm9ybWF0KG5ldyBEYXRlKHN0cmVhbS53ZWVrc1tzdHJlYW1JbmRleF0uZmlyc3REYXkpLCAnTExMIGRvJyl9ICgke3N0cmVhbS53ZWVrc1tzdHJlYW1JbmRleF0ubm9kZXMubGVuZ3RofSBub2RlcylgLAogICAgICAgICAgICAgIG5vZGVzOiBzdHJlYW0ud2Vla3Nbc3RyZWFtSW5kZXhdLm5vZGVzCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgfSkKCiAgICAgICAgLy8gTWFrZSBjaGFydCByZXNwb25zaXZlCiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIG15Q2hhcnQucmVzaXplKCkKICAgICAgICB9KQoKICAgICAgICByZXR1cm4gbXlDaGFydAogICAgICB9CgogICAgICBmdW5jdGlvbiB0b2dnbGVWaWV3TW9kZSgpIHsKICAgICAgICBjb25zdCBzd2l0Y2hFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXctbW9kZS1zd2l0Y2gnKQoKICAgICAgICB1cGRhdGVBbGxDaGFydHMoc3dpdGNoRWxlbWVudC5jaGVja2VkID8gJ25vZGVzJyA6ICdwb2ludHMnKQogICAgICB9CgogICAgICBjb25zdCBmaWx0ZXJlZERhdGFzZXQgPSAoZ3JvdXBNZXRyaWNzKSA9PiB7CiAgICAgICAgaWYgKGdyb3VwTWV0cmljcy5xdWVyeSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICByZXR1cm4gJycKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIGBPdmVyYWxsIHByb2plY3QgZGF0YSBmaWx0ZXJlZDogJHtKU09OLnN0cmluZ2lmeShncm91cE1ldHJpY3MucXVlcnkpfSAgPGJyIC8+YAogICAgICAgIH0KICAgICAgfQoKICAgICAgLy8gRnVuY3Rpb24gdG8gaW5pdGlhbGl6ZSB0aGUgZGFzaGJvYXJkIG1ldGFkYXRhCiAgICAgIGZ1bmN0aW9uIGluaXRpYWxpemVEYXNoYm9hcmQoKSB7CiAgICAgICAgLy8gU2V0IGRhc2hib2FyZCB0aXRsZSBhbmQgbWV0YWRhdGEgZnJvbSB0aGUgZGF0YSBvYmplY3QKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGFzaGJvYXJkLXRpdGxlJykudGV4dENvbnRlbnQgPQogICAgICAgICAgZ3JvdXBNZXRyaWNzLm5hbWUKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGFzaGJvYXJkLWRlc2NyaXB0aW9uJykudGV4dENvbnRlbnQgPQogICAgICAgICAgZ3JvdXBNZXRyaWNzLmRlc2NyaXB0aW9uCgogICAgICAgIGlmIChncm91cE1ldHJpY3MucXVlcnkgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rhc2hib2FyZC1wcm9qZWN0ZmlsdGVyJykudGV4dENvbnRlbnQgPSAnJwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGFzaGJvYXJkLXByb2plY3RmaWx0ZXInKS50ZXh0Q29udGVudCA9CiAgICAgICAgICAgIGBPdmVyYWxsIHByb2plY3QgZGF0YSBmaWx0ZXJlZDogJHtKU09OLnN0cmluZ2lmeShncm91cE1ldHJpY3MucXVlcnkpfWAKICAgICAgICB9CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXNoYm9hcmQtbWV0YWRhdGEnKS50ZXh0Q29udGVudCA9CiAgICAgICAgICBgTGFzdCB1cGRhdGVkOiAke2dyb3VwTWV0cmljcy51cGRhdGVkQXR9YAoKICAgICAgICBjb25zdCBkZWZhdWx0TWV0cmljID0KICAgICAgICAgIGdyb3VwTWV0cmljcy5kZWZhdWx0TWV0cmljICE9PSB1bmRlZmluZWQKICAgICAgICAgICAgPyBncm91cE1ldHJpY3MuZGVmYXVsdE1ldHJpYwogICAgICAgICAgICA6ICdwb2ludHMnCgogICAgICAgIHVwZGF0ZUFsbENoYXJ0cyhkZWZhdWx0TWV0cmljKQoKICAgICAgICAvLyBTZXQgdXAgZXZlbnQgbGlzdGVuZXIgZm9yIHZpZXcgbW9kZSBzd2l0Y2gKICAgICAgICBjb25zdCBzd2l0Y2hFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXctbW9kZS1zd2l0Y2gnKQogICAgICAgIHN3aXRjaEVsZW1lbnQuY2hlY2tlZCA9IGRlZmF1bHRNZXRyaWMgPT09ICdub2RlcycKCiAgICAgICAgc3dpdGNoRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0b2dnbGVWaWV3TW9kZSkKCiAgICAgICAgdXBkYXRlU3RyZWFtc1RhYmxlKGdyb3VwTWV0cmljcykKICAgICAgfQoKICAgICAgZnVuY3Rpb24gdXBkYXRlQWxsQ2hhcnRzKG1ldHJpYykgewogICAgICAgIGNvbnNvbGUubG9nKCdVcGRhdGluZyBhbGwgY2hhcnRzIHRvIGRpc3BsYXkgbWV0cmljOicsIG1ldHJpYykKICAgICAgICBjcmVhdGVXZWVrbHlDb21wbGV0aW9uQ2hhcnQoCiAgICAgICAgICAnd2Vla2x5Y29tcGxldGlvbmNoYXJ0JywKICAgICAgICAgIGdyb3VwTWV0cmljcywKICAgICAgICAgIG1ldHJpYwogICAgICAgICkKCiAgICAgICAgY3JlYXRlV2Vla2x5VmVsb2NpdHlDaGFydCgnd2Vla2x5dmVsb2NpdHljaGFydCcsIGdyb3VwTWV0cmljcywgbWV0cmljKQoKICAgICAgICBjcmVhdGVFZmZvcnREaXN0cmlidXRpb25DaGFydCgKICAgICAgICAgICdlZmZvcnRkaXN0cmlidXRpb25jaGFydCcsCiAgICAgICAgICBncm91cE1ldHJpY3MsCiAgICAgICAgICBtZXRyaWMKICAgICAgICApCiAgICAgIH0KCiAgICAgIC8vIEluaXRpYWxpemUgYWxsIGNoYXJ0cyB3aGVuIERPTSBpcyBsb2FkZWQKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXRpYWxpemVEYXNoYm9hcmQpCiAgICA8L3NjcmlwdD4KICA8L2JvZHk+CjwvaHRtbD4K'

export default tpl
